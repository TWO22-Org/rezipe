---
name: YouTube API integration with recipe bias
status: completed
created: 2026-01-15T21:18:02Z
updated: 2026-01-18T21:34:44Z
github: https://github.com/TWO22-Org/rezipe/issues/15
depends_on: []
parallel: true
conflicts_with: []
---

# Task: YouTube API integration with recipe bias

## Description
Create YouTube search service with query augmentation to bias results toward recipe/cooking content.

## Acceptance Criteria
- [x] YouTube Data API v3 client
- [x] Query augmentation (add "recipe", "cooking")
- [x] Category restriction (How-to & Style: 26)
- [x] SafeSearch strict enabled
- [x] Response transformed to app format
- [x] API key from environment secrets

## Technical Details
- TypeScript service for YouTube API
- Append invisible terms to query
- videoCategoryId: 26 when possible
- safeSearch: strict
- Return: video_id, title, channel_title, thumbnail_url
- Files: src/backend/functions/_shared/youtube.ts

## Dependencies
- [x] YouTube Data API v3 access
- [x] API key in Supabase secrets

## Effort Estimate
- Size: M
- Hours: 4-5
- Parallel: true

## Implementation Notes
- Created `src/backend/functions/_shared/youtube.ts` with:
  - `searchYouTube()` - main export function
  - `augmentQuery()` - appends "recipe OR cooking" to queries
  - `buildSearchURL()` - builds YouTube API URL with all required params
  - `parseRegionFromLocale()` - extracts country code from BCP-47 locale (e.g., en-US → US)
  - `transformResponse()` - maps API response to app format
  - `YouTubeAPIError` - typed error class with retryable hints
- Created `src/backend/tests/youtube_test.ts` with comprehensive unit tests
- Updated `.env.example` with `YOUTUBE_API_KEY`
- Uses Zod for runtime validation of API responses
- Clamps maxResults to YouTube's valid range (1-50)
- `relevanceLanguage` always set to "en" to bias toward English content
- `regionCode` only set when explicit country provided (e.g., en-US → US)
- `videoEmbeddable=true` and `videoSyndicated=true` for embed compliance
